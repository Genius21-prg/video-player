<script>
  const {extendObservable} = mobx;

  class StateManager {
    constructor() {
      extendObservable(this, {
        playState: 'PAUSED',
        position: 0,
        playbackRate: 1,
        volume: 1,
        muted: false,
        duration: 0,
      })
    }

    play() {
      this.playState = 'PLAYING';
    }

    pause() {
      this.playState = 'PAUSED';
    }

    togglePlayPause() {
      if(this.playState == 'PLAYING') {
        this.pause()
      } else {
        this.play();
      }
    }

    seek(seconds) {
      this.position = seconds;
    }

    setPlaybackRate(playbackRate) {
      this.playbackRate = playbackRate;
    }

    toggleMute() {
      if(this.muted) {
        this.unmute()
      } else {
        this.mute();
      }
    }

    mute() {
        this.muted = true;
    }

    unmute() {
        this.muted = false;
    }



    setVolume(volume) {
      // always unmuted first to avoid potential inconsistent states between e.g. mute button icon and sound-control-bar
      this.unmute();
      if(volume >= 0 || volume <= 100) {
        this.volume = volume;
      }
    }

    setDuration(duration) {
      this.duration=duration;
    }
  }
</script>
