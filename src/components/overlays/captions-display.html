<link rel="import" href="../../../bower_components/imd/imd.html">

<link rel="import" href="../../base-element.html">

<dom-module id="captions-display">
  <template>
    <style type="text/css">
      #container__captions {
        visibility: visible;
        position: absolute;
        bottom: 15px;
        width: calc(100% - 60px);
        padding: 3px 20px;
        text-align: center;
        background-color: rgba(0,0,0,0.7);
        border-radius: 5px;
        margin: 0 10px;
        color: white;
      }
    </style>

    <div id="container__captions" style$="visibility: [[ifThenElse(isVisible, 'visible', 'hidden')]];">
      [[currentCaptionCue.text]]
    </div>
  </template>

  <script>
    define('captions-display', ['base-element', 'constants'], (BaseElement, constants) => {

      class CaptionsDisplay extends BaseElement {
        static get is() { return 'captions-display'; }

        static get properties() {
          return {
            state: Object,
            stateManager: Object,
            isVisible: {
              type: Boolean,
              computed: '_isVisible(state.selectedCaption)',
            }
          };
        }

        static get observers() {
          return [
            'captionCueChanged(state.currentCaption)'
          ];
        }

        captionsChanged(newCaptions) {
          console.log('new captions!');
          console.log(newCaptions);
        }

        captionCueChanged(newCue) {
          console.log('new cue!');
          console.log(newCue);
          this.currentCaptionCue = newCue;
        }

        _isVisible(selectedCaption) {
          return selectedCaption !== 'off';
        }
      }

      window.customElements.define(CaptionsDisplay.is, CaptionsDisplay);
    });
  </script>

</dom-module>
