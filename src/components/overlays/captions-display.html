<link rel="import" href="../../../bower_components/imd/imd.html">

<link rel="import" href="../../base-element.html">

<dom-module id="captions-display">
  <template>
    <style type="text/css">
      #container__captions {
        visibility: visible;
        position: absolute;
        bottom: 5px;
        width: calc(100% - 40px);
        margin: 0 20px;
        text-align: center;
        color: white;
        z-index: 3;
      }
      .caption-cue-text {
        /* display:table; is necessary so the inner element (.caption-cue-text)
           does not take up the full available width. */
        display: table;
        margin: 0 auto;
        padding: 3px 10px;
        background-color: rgba(0,0,0,0.7);
        border-radius: 5px;
      }
    </style>

    <div id="container__captions" style$="visibility: [[ifThenElse(isVisible, 'visible', 'hidden')]];">
      <div class="caption-cue-text">[[currentCaptionCue.text]]</div>
    </div>
  </template>

  <script>
    define('captions-display', ['base-element'], (BaseElement) => {

      class CaptionsDisplay extends BaseElement {
        static get is() { return 'captions-display'; }

        static get properties() {
          return {
            state: Object,
            stateManager: Object,
            currentCaptionCue: Object,
            isVisible: {
              type: Boolean,
              computed: '_isVisible(state.selectedCaption)',
            },
          };
        }

        static get observers() {
          return [
            'captionCueChanged(state.currentCaptionCue)',
            // 'captionsChanged(state.selectedCaption)',
          ];
        }

        // If needed later on
        // captionsChanged(newCaptions) {
        //   // Here we can make adjustments when the user changes the captions,
        //   // i.e. by choosing their language or turning them off
        // }

        captionCueChanged(newCue) {
          this.currentCaptionCue = newCue;
        }

        _isVisible(selectedCaption) {
          return selectedCaption !== 'off';
        }
      }

      window.customElements.define(CaptionsDisplay.is, CaptionsDisplay);
    });
  </script>

</dom-module>
