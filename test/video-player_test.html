<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, minimum-scale=1, initial-scale=1, user-scalable=yes">

    <title>video-player test</title>


    <script src="../bower_components/webcomponentsjs/webcomponents-lite.js"></script>
    <script src="../bower_components/web-component-tester/browser.js"></script>

    <link rel="import" href="../src/video-player.html">
  </head>
  <body>

    <test-fixture id="complex-video-player-fixture">
      <template>
        <video-player
        configuration='{
        "streams" : [
          {
            "hd": "/components/videoplayer/test/BigBuckBunny30s.mp4",
            "sd": "/components/videoplayer/test/BigBuckBunny30s.mp4",
            "poster": "/components/videoplayer/demo/poster_1.jpg"
          },
          {
            "hd": "/components/videoplayer/test/BigBuckBunny30s.mp4",
            "sd": "/components/videoplayer/test/BigBuckBunny30s.mp4",
            "poster": "/components/videoplayer/demo/poster_2.jpg"
          },
          {
            "hd": "/components/videoplayer/test/BigBuckBunny30s.mp4",
            "sd": "/components/videoplayer/test/BigBuckBunny30s.mp4",
            "poster": "/components/videoplayer/demo/poster_1.jpg"
          }
        ],
        "captions" : [
          {
            "language" : "de",
            "url" : "/components/videoplayer/demo/captions/subtitles_de.vtt"
          },
          {
            "language" : "en",
            "url" : "/components/videoplayer/demo/captions/subtitles_en.vtt"
          },
          {
            "language" : "fr",
            "url" : "/components/videoplayer/demo/captions/subtitles_fr.vtt"
          }
        ],
        "slides" : [
          {
            "thumbnail" : "/components/videoplayer/test/bbb-splash.png",
            "startPosition" : 0
          }
        ],
        "initialState": {
          "volume": 0.75
        },
        "userPreferences": {
          "quality": "sd",
          "playbackRate": 1.3
        },
        "chapters": [
          {
            "title": "Das Internet - Netz der Netze",
            "startPosition": 0
          },
          {
            "title": "Basiskomponeneten von Netzwerken",
            "startPosition": 15
          }
        ]
      }'></video-player>
      </template>
    </test-fixture>

    <test-fixture id="simple-video-player-fixture">
      <template>
        <video-player
        configuration='{
        "streams" : [
          {
            "hd": "/components/videoplayer/test/BigBuckBunny30s.mp4",
            "sd": "/components/videoplayer/test/BigBuckBunny30s.mp4",
            "poster": "/components/videoplayer/demo/poster_1.jpg"
          }
        ]
      }'></video-player>
      </template>
    </test-fixture>

    <script>

      suite('video-player', function() {
        let videoPlayer;

        setup(function() {
          // We want to run tests with an empty local storage to avoid
          // unintended side effects and to start with a clean slate in each
          // test file.
          if (localStorage) {
            localStorage.clear();
          } else if (window.localStorage) {
            window.localStorage.clear();
          }
        });

        test('testing a simple video player setup with one stream', function() {
          videoPlayer = fixture('simple-video-player-fixture');
          assert.isNotNull(videoPlayer.configuration, 'there is a configuration');
          // Testing whether all stateManager values are at their set value
          assert.equal(videoPlayer.state.position, 0, 'position value is at default');
          assert.equal(videoPlayer.state.duration, 0, 'duration value is at default');
          assert.equal(videoPlayer.state.playbackRate, 1.0, 'playback rate value is at default');
          assert.equal(videoPlayer.state.volume, 1, 'volume value is at default');
          assert.equal(videoPlayer.state.muted, false, 'muted value is at default');
          assert.equal(videoPlayer.state.fullscreen, false, 'full screen value is at default');
        });

        test('testing a complex video player setup with three streams', function() {
          videoPlayer = fixture('complex-video-player-fixture');
          assert.isNotNull(videoPlayer.configuration, 'there is a configuration');
          // Testing whether all stateManager values are at their set value
          assert.equal(videoPlayer.state.position, 0, 'position value is at default');
          assert.equal(videoPlayer.state.duration, 0, 'duration value is at default');
          assert.equal(videoPlayer.state.playbackRate, 1.3, 'playback rate value is at set value');
          assert.equal(videoPlayer.state.volume, 0.75, 'volume value is at set value');
          assert.equal(videoPlayer.state.muted, false, 'muted value is at default');
          assert.equal(videoPlayer.state.fullscreen, false, 'full screen value is at default');
        });

      });
    </script>

  </body>
</html>
